// backend/routes/cropRoutes.js
import express from "express";
import { spawn } from "child_process";

const router = express.Router();

// POST /api/predict
router.post("/predict", (req, res) => {
  const features = req.body; // rainfall, temperature, soil_ph, etc.

  // Call Python script for prediction
  const python = spawn("python3", ["backend/models/predict.py", JSON.stringify(features)]);

  python.stdout.on("data", (data) => {
    res.json({ predicted_yield: data.toString() });
  });

  python.stderr.on("data", (data) => {
    console.error(`Error: ${data}`);
    res.status(500).json({ error: "Prediction failed" });
  });
});

export default router;
